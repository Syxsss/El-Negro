(()=>{"use strict";let e=class{constructor(e){this.apiURL="https://render.logora.fr",this.shortname=e}renderSynthesis(e,t,r,n,i,o,l,a,s,u){let c="/"+e+"?shortname="+this.shortname+"&uid="+t;return r&&(c=c+"&insertType="+r),!1===o&&(c+="&cache=false"),u&&(c=c+"&device="+u),a&&(c=c+"&language="+a),s&&(c=c+"&redirectUrl="+s),this.client_post(c,{source:n,debate:i,config:l})}renderEmbed(e,t,r,n,i,o,l){let a="/embed/"+e+"?shortname="+this.shortname+"&id="+t;return!1===n&&(a+="&cache=false"),a+="&insertType=iframe",i&&(a=a+"&device="+i),o&&(a=a+"&language="+o),l&&(a=a+"&redirectUrl="+l),this.client_post(a,{source:r})}client_post(e,t){let r=this.apiURL+e,n=new Headers({"Content-Type":"application/x-www-form-urlencoded"});return new Promise((e,i)=>{fetch(r,{method:"post",body:this.serialize(t),headers:n}).then(e=>e.json()).then(t=>{e(t)}).catch(e=>{i(e)})})}serialize(e,t){let r=[],n;for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=t?t+"["+n+"]":n,o=e[n];r.push(null!==o&&"object"==typeof o?this.serialize(o,i):encodeURIComponent(i)+"="+encodeURIComponent(o))}return r.join("&")}};function t(e,t){return new URL(t,e).href}let r={description:{rules:[['meta[property="og:description"]',e=>e.getAttribute("content")],["description",e=>e,!0],['meta[name="description" i]',e=>e.getAttribute("content")]]},icon:{rules:[['link[rel="apple-touch-icon"]',e=>e.getAttribute("href")],['link[rel="apple-touch-icon-precomposed"]',e=>e.getAttribute("href")],['link[rel="icon" i]',e=>e.getAttribute("href")],['link[rel="fluid-icon"]',e=>e.getAttribute("href")],['link[rel="shortcut icon"]',e=>e.getAttribute("href")],['link[rel="Shortcut Icon"]',e=>e.getAttribute("href")],['link[rel="mask-icon"]',e=>e.getAttribute("href")]],scorers:[(e,t)=>{let r=e.getAttribute("sizes");if(r){let e=r.match(/\d+/g);if(e)return e[0]}}],defaultValue:e=>"favicon.ico",processors:[(e,r)=>t(r.url,e)]},image:{rules:[['meta[property="og:image:secure_url"]',e=>e.getAttribute("content")],['meta[property="og:image"]',e=>e.getAttribute("content")],['meta[property="og:image:url"]',e=>e.getAttribute("content")],['meta[name="twitter:image"]',e=>e.getAttribute("content")],['meta[property="twitter:image"]',e=>e.getAttribute("content")],['meta[name="thumbnail"]',e=>e.getAttribute("content")]],processors:[(e,r)=>t(r.url,e)]},keywords:{rules:[['meta[name="keywords" i]',e=>e.getAttribute("content")],['meta[property="article:tag"]',e=>e.getAttribute("content"),!1,!0],["keywords",e=>e,!0]],processors:[(e,t)=>{let r=[];return e&&(Array.isArray(e)?r=e.flatMap(e=>"string"==typeof e||e instanceof String?e.split(",").map(e=>e.trim()):[]):("string"==typeof e||e instanceof String)&&(r=e.split(",").map(e=>e.trim()))),r.filter((e,t,r)=>r.indexOf(e)===t)}]},title:{rules:[['meta[property="og:title"]',e=>e.getAttribute("content")],["headline",e=>e,!0],['meta[name="twitter:title"]',e=>e.getAttribute("content")],['meta[property="twitter:title"]',e=>e.getAttribute("content")],['meta[name="hdl"]',e=>e.getAttribute("content")],["title",e=>e.text]]},language:{rules:[["html[lang]",e=>e.getAttribute("lang")],['meta[name="language" i]',e=>e.getAttribute("content")]],processors:[(e,t)=>e.split("-")[0]]},type:{rules:[['meta[property="og:type"]',e=>e.getAttribute("content")]]},url:{rules:[["a.amp-canurl",e=>e.getAttribute("href")],['link[rel="canonical"]',e=>e.getAttribute("href")],['meta[property="og:url"]',e=>e.getAttribute("content")]],defaultValue:e=>e.url,processors:[(e,r)=>t(r.url,e)]},provider:{rules:[['meta[property="og:site_name"]',e=>e.getAttribute("content")]],defaultValue:e=>new URL(e.url).host.replace(/www[a-zA-Z0-9]*\./,"").replace(".co.",".").split(".").slice(0,-1).join(" ")},publishedDate:{rules:[['meta[property~="article:published_time"]',e=>e.getAttribute("content")],['meta[property~="og:updated_time"]',e=>e.getAttribute("content")],["datePublished",e=>e,!0]]}};function n(e,t="resource"){window.dispatchEvent(new CustomEvent("logoraContentLoaded",{detail:{[t]:e}}))}function i(e,t,r,n,i){let o=document.querySelectorAll(e);if(o)for(let e=0;e<o.length;++e){let l=o[e].getAttribute("data-object-id"),a=window[l||"logora_config"];(null==a?void 0:a.shortname)&&i(o[e],a,t,r,n)}else console.log(`[LOGORA] Cannot find ${e} container`)}!function(e,t,r,n,o){"undefined"!=typeof document&&("loading"!==document.readyState?i(e,null,null,null,o):document.addEventListener("DOMContentLoaded",function(){i(e,null,null,null,o)}))}(".logora_synthese",0,0,0,function(t,i){var o,l;let a=new e(i.shortname,i.api_key),s=!!(l=t.getBoundingClientRect().width.toFixed(2))&&(l>=769?"desktop":l<769&&l>=565?"tablet":"mobile");if(!1===window.logoraDisplayAds&&(i.ads={display:!1}),!i.debate.identifier)return console.log("[Logora] Cannot get page identifier. Check that 'debate.identifier' is set in the configuration variables."),!1;let u=function(e){let t=function(){let e=function(e,t,n,i=[]){let o={},l={url:t,jsonLd:function(e,t){let r=e.querySelectorAll('script[type="application/ld+json"]');try{for(let e=0;e<r.length;e++){let n=JSON.parse(r[e].textContent);if(t.includes(n["@type"]))return n}}catch(e){}return{}}(e,i)};return Object.keys(r).map(t=>{var n;let i=(n=r[t],(e,t)=>{let r,i=0,o={};for(let l=0;l<n.rules.length;l++){let a;let[s,u,c,d]=n.rules[l];if(d)o[s]||(o[s]=[]),a=Array.from(e.querySelectorAll(s)),o[s].push(...a.map(u));else if((a=t.jsonLd&&c?[t.jsonLd[s]]:Array.from(e.querySelectorAll(s))).length){for(let e of a)if(e){let t=n.rules.length-l;if(n.scorers)for(let r of n.scorers){let n=r(e,t);n&&(t=n)}t>i&&(i=t,r=u(e))}}}if(Object.keys(o).forEach(e=>{let t=o[e].join(", ");t.trim()&&(r=t.trim())}),!r&&n.defaultValue&&(r=n.defaultValue(t)),r){if(n.processors)for(let e of n.processors)r=e(r,t);return r.trim&&(r=r.trim()),r}});o[t]=i(e,l)}),o}(window.document,window.location,0,["Article","NewsArticle"]);return{source_url:e.url,published_date:e.publishedDate||"",title:e.title,description:e.description,origin_image_url:e.image||"",publisher:e.provider,tag_objects:e.keywords?[...new Set(e.keywords.map(e=>e.toLowerCase()))].map(e=>({name:e})).slice(0,10):[]}}();return"source"in e&&"tag_objects"in e.source?(e.source.tag_objects&&(e.source.tag_objects=function(e){e.filter(e=>{e.uid&&(e.uid=e.uid.toLowerCase()),e.name&&(e.name=e.name.toLowerCase())});let t=[];return e.filter(e=>(-1>=t.findIndex(t=>e.uid?t.uid==e.uid:t.name==e.name)&&t.push(e),null)),t.slice(0,10)}(e.source.tag_objects)),Object.assign(t,e.source)):t}(i);if("published_date"in u&&function(e,t){let r=new Date,n=new Date(t||new Date().setMonth(new Date().getMonth()-18)),i=new Date(e||null),o=i<n||i>r;return o&&console.log(`[LOGORA] Source is too old or in the future, and will not be collected. Source expiration date is ${n}`),o}(u.published_date,null==(o=i.synthesis)?void 0:o.pageExpirationDate)&&"amp"!==i.debate.insertType)return!1;a.renderSynthesis("synthesis",i.debate.identifier,i.debate.insertType,u,i.debate,!0,function(e){let t={};return t.shortname=e.shortname,"synthesis"in e&&(t.synthesis=e.synthesis),"modules"in e&&(t.modules=e.modules),"ads"in e&&(t.ads=e.ads),"remote_auth"in e&&(t.remote_auth=e.remote_auth),"login_url"in e&&(t.login_url=e.login_url),"registration_url"in e&&(t.registration_url=e.registration_url),"auth"in e&&(t.auth=e.auth),"language"in e&&(t.language=e.language),t}(i),i.language,i.redirectUrl,s).then(e=>{var r;return e.success?(r=e.content,t.innerHTML=r,Array.from(t.querySelectorAll("script")).forEach(e=>{let t=document.createElement("script");Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(e.innerHTML)),e.parentNode.replaceChild(t,e)}),n(e.debate||e.source,"debate"),!0):(n(null,"debate"),!1)}).catch(e=>(n(null,"debate"),!1))})})();